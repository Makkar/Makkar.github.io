<!DOCTYPE html><html lang="en-us" >

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.8.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Aditya Makkar">

  
  
  
    
  
  <meta name="description" content="A probabilistic analysis">

  
  <link rel="alternate" hreflang="en-us" href="https://makkar.github.io/post/lisprob/">

  


  
  
  
  <meta name="theme-color" content="rgb(0, 136, 204)">
  

  
  
  
  <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-1/css/all.min.css" integrity="sha256-4w9DunooKSr3MFXHXWyFER38WmPdm361bQS/2KUWZbU=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css" crossorigin="anonymous" title="hl-light" disabled>
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark">
        
      
    

    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js" integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inconsolata:wght@200;300;400;500;600;700;800;900&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  




  


  
  

  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hu6726f8512450ca078cf8b558674bfa85_44401_32x32_fill_lanczos_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hu6726f8512450ca078cf8b558674bfa85_44401_192x192_fill_lanczos_center_2.png">

  <link rel="canonical" href="https://makkar.github.io/post/lisprob/">

  
  
  
  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="og:site_name" content="Aditya Makkar">
  <meta property="og:url" content="https://makkar.github.io/post/lisprob/">
  <meta property="og:title" content="Longest Increasing Subsequence | Aditya Makkar">
  <meta property="og:description" content="A probabilistic analysis"><meta property="og:image" content="https://makkar.github.io/images/icon_hu6726f8512450ca078cf8b558674bfa85_44401_512x512_fill_lanczos_center_2.png">
  <meta property="twitter:image" content="https://makkar.github.io/images/icon_hu6726f8512450ca078cf8b558674bfa85_44401_512x512_fill_lanczos_center_2.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2020-12-25T17:17:08-05:00">
    
    <meta property="article:modified_time" content="2020-12-25T17:17:08-05:00">
  

  


    






  




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://makkar.github.io/post/lisprob/"
  },
  "headline": "Longest Increasing Subsequence",
  
  "datePublished": "2020-12-25T17:17:08-05:00",
  "dateModified": "2020-12-25T17:17:08-05:00",
  
  "author": {
    "@type": "Person",
    "name": "Aditya Makkar"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "Aditya Makkar",
    "logo": {
      "@type": "ImageObject",
      "url": "https://makkar.github.io/images/icon_hu6726f8512450ca078cf8b558674bfa85_44401_192x192_fill_lanczos_center_2.png"
    }
  },
  "description": "A probabilistic analysis"
}
</script>

  

  


  


  





  <title>Longest Increasing Subsequence | Aditya Makkar</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="dark">

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  







<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>Home</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#research"><span>Research</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/hilbert/"><span>Hilbert's Hotel - Blog</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      

      

      

    </ul>

  </div>
</nav>


  <article class="article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1>Longest Increasing Subsequence</h1>

  
  <p class="page-subtitle">A probabilistic analysis</p>
  

  
    


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    Dec 25, 2020
  </span>
  

  

  

  
  
  

  
  

</div>

    














  
</div>



  <div class="article-container">

    <div class="article-style">
      <p>$$
\newcommand{\R}{\mathbb{R}}
\newcommand{\RR}{\overline{\mathbb{R}}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\ZZ}{\Z_{\geq 0}^N}
\newcommand{\N}{\mathbb{N}}
\newcommand{\NN}{\mathcal{N}}
\newcommand{\LL}{\mathcal{L}}
\newcommand{\PP}{\mathbb{P}}
\newcommand{\OO}{\mathcal{O}}
\newcommand{\I}{\mathcal{I}}
\newcommand{\Prob}[1]{\PP \left( #1 \right)}
\newcommand{\eq}[1]{\begin{align*}#1\end{align*}}
\newcommand{\eql}[1]{\begin{align}#1\end{align}}
\newcommand{\ind}[1]{\mathbf{1}_{#1}}
\newcommand{\indo}[1]{\mathbf{1}_{#1}(\omega)}
\newcommand{\F}{\mathcal{F}}
\newcommand{\G}{\mathcal{G}}
\newcommand{\EE}{\mathcal{E}}
\newcommand{\probsp}{(\Omega, \F, \PP)}
\newcommand{\integ}[1]{\int_{\Omega} #1 \dmu}
\newcommand{\B}{\mathcal{B}}
\newcommand{\Bo}{\B(\R)}
\newcommand{\Bon}[1]{\B(\R^{#1})}
\newcommand{\limn}{\lim_{n \to \infty}}
\newcommand{\lims}{\limsup_{n \to \infty}}
\newcommand{\limi}{\liminf_{n \to \infty}}
\newcommand{\sumn}{\sum_{n=1}^{\infty}}
\newcommand{\trans}{\intercal}
\newcommand\inner[2]{\langle #1, #2 \rangle}
\newcommand{\norm}[1]{\left\lVert#1\right\rVert}
\newcommand{\modu}[1]{\lvert#1\rvert}
\newcommand{\conj}[1]{\overline{#1}}
\newcommand{\matr}[1]{\mathbf{#1}}
\newcommand{\e}{\epsilon}
\newcommand{\ex}[1]{\exp\left{#1\right}}
\newcommand{\comp}{\mathsf{c}}
\newcommand{\emp}{\varnothing}
\newcommand{\floor}[1]{\left \lfloor{#1}\right \rfloor}
\newcommand{\ceil}[1]{\left \lceil{#1}\right \rceil}
\newcommand{\se}[1]{\left\{ #1 \right\}}
\newcommand{\set}[2]{\left\{ #1 ; : ; #2 \right\}}
\newcommand{\sett}[2]{\left\{ #1 ; | ; #2 \right\}}
\newcommand{\Ex}[1]{\E\left[#1\right]}
\newcommand{\pard}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\dd}{\mathrm{d}}
\newcommand{\ph}[1]{\varphi^{-1}\left(#1\right)}
\DeclareMathOperator{\dx}{dx}
\DeclareMathOperator{\dy}{dy}
\DeclareMathOperator{\du}{du}
\DeclareMathOperator{\dz}{d\matr{z}}
\DeclareMathOperator{\dt}{dt}
\DeclareMathOperator{\dmu}{d\mu}
\DeclareMathOperator{\dom}{d\omega}
\DeclareMathOperator{\dP}{d\PP}
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator{\Ord}{\mathcal{O}}
\DeclareMathOperator{\E}{\mathbb{E}}
\DeclareMathOperator{\V}{\mathrm{Var}}
\DeclareMathOperator{\Log}{\mathrm{Log}}
\DeclareMathOperator{\O}{\mathcal{O}}
$$</p>
<h1 id="introduction">Introduction</h1>
<p>Finding a longest increasing subsequence is a well-known problem in computer science (note that I use the article &ldquo;a&rdquo; instead of &ldquo;the&rdquo; because there could be multiple longest subsequences): Given a sequence $\se{a_1, \ldots, a_n}$ of real numbers, we want to find a subsequence $\se{a_{i_1}, \ldots, a_{i_k}}$ such that $0 \le i_1 &lt; \cdots &lt; i_k \le n$, $a_{i_1} \le \cdots \le a_{i_k}$, and the subsequence is as long as possible. It has a very easy 
<a href="https://www.geeksforgeeks.org/longest-increasing-subsequence-dp-3/" target="_blank" rel="noopener">dynamic programming</a> solution with a time complexity of $\O(n^2)$ and a slightly 
<a href="https://en.wikipedia.org/wiki/Longest_increasing_subsequence#Efficient_algorithms" target="_blank" rel="noopener">more involved solution</a> with a time complexity of $\O(n \log n)$. But we are not interested in these algorithms in this blog post.</p>
<p>We are interested in studying the asymptotics of the <em>length</em> of the longest increasing subsequences of a sequence whose elements are coming from a random permutation. This simple to state problem will take us on a beautiful journey touching topics from combinatorics and probability theory. In particular, we will get to see the very elegant technique of Poissonization.</p>
<h1 id="problem">Problem</h1>
<p>Let us start by stating precisely what we are trying to prove. To do that we first define some notation. For any integer $n \ge 1$, let $S_n$ be the group of permutations of order $n$, i.e., it contains all permutations of $\se{1, 2, \ldots, n}$ and hence $S_n$ contains $n!$ elements.  If $\pi \in S_n$ then a subsequence of $\pi$ is a sequence $\se{\pi(i_1), \ldots, \pi(i_k)}$ such that $1 \leq i_1 &lt; \cdots &lt; i_k \leq n$. It is an increasing subsequence if $\pi(i_1) &lt; \cdots &lt; \pi(i_k)$ and similarly for the decreasing subsequence. Consider the uniform measure $\mu_n$ on the discrete measurable space $(S_n, 2^{S_n})$, i.e., $\mu_n(\pi) = 1 / n!$ for any $\pi \in S_n$. For $\pi \in S_n$ define $l_n(\pi)$ to be the maximal length of an increasing subsequence of $\pi$, i.e., $l_n(\pi)$ is the largest $k$ such that there are integers $1 \leq i_1 &lt; \cdots &lt; i_k \leq n$ so that $\pi(i_1) &lt; \cdots &lt; \pi(i_k)$. Similarly define $d_n(\pi)$ to be the maximal length of a decreasing subsequence of $\pi$.</p>
<p>Since $l_n$ is a random variable we can consider its expectation $L_n = \E[l_n]$ on the probability space $(S_n, 2^{S_n}, \mu_n)$. It can be explicitly written as
$$
L_n = \frac{1}{n!} \sum_{\pi \in S_n} l_n(\pi) \tag{1} \label{eq1}
$$
We want to study the limiting properties of the sequence $\se{L_n}_{n \in \N}$. Specifically we will show that
$$
\frac{L_n}{\sqrt{n}} \to \gamma \text{ almost surely} \tag{2} \label{eq2}
$$
for some constant $\gamma$. It is known that $\gamma = 2$. We will not be showing this, but we will show that $1 \le \gamma \le e$.</p>
<h1 id="combinatorial-results">Combinatorial results</h1>
<p>We now prove some useful combinatorial results. The first result is called the Erdős–Szekeres theorem.</p>
<p><span style="color:darkgray; font-size: 16pt">Theorem 1 [Erdős–Szekeres theorem]: </span> In any sequence $\se{a_1, a_2, \ldots, a_{mn+1}}$ of $mn+1$ distinct real numbers, there exists either an increasing subsequence $a_{i_1} &lt; \cdots &lt; a_{i_{m+1}}$ $(i_1 &lt; \cdots &lt; i_{m+1})$ of length $m+1$, or a decreasing subsequence $a_{j_1} &gt; \cdots &gt; a_{j_{n+1}}$ $(j_1 &lt; \cdots &lt; j_{n+1})$ of length $n+1$.</p>
<p><span style="color:darkgray; font-size: 16pt">Proof: </span> For $1 \leq i \leq mn+1$ define $t_i$ to be the length of a longest increasing subsequence starting at $a_i$, i.e., the first element of a longest increasing subsequence must be $a_i$ and the rest of the $a$'s must have indices greater than $i$. If $t_i \geq m+1$ for some $i$ then we are done since we then have an increasing subsequence of length $m+1$, so assume $t_i \leq m$ for all $i$. Since $t_i \geq 1$, pigeonhole principle now implies that there is some integer $1 \leq k \leq m$ such that $t_i = k$ for at least $n+1$ $i$'s. Let $t_i = k$ for all $i \in (j_1 &lt; \cdots &lt; j_{n+1})$. Now note that if $a_{j_l} &lt; a_{j_{l+1}}$ for some $1 \leq l \leq n$, then we would obtain an increasing subsequence of length $k+1$ starting at $a_{j_l}$ because there is an increasing subsequence of length $k$ starting at $a_{j_{l+1}}$. But this contradicts the fact that $t_{j_l} = k,$ and thus $a_{j_l} &gt; a_{j_{l+1}}$ for all $1 \leq l \leq n$. But now this gives us a decreasing subsequence $a_{j_1} &gt; \cdots &gt; a_{j_{n+1}}$ of length $n+1$. $\square$</p>
<p>The next two theorems prove lower and upper bounds for $L_n / \sqrt{n}$.</p>
<p><span style="color:darkgray; font-size: 16pt">Theorem 2: </span> $L_n / \sqrt{n}$ is lower bounded as follows
$$
L_n \geq \sqrt{n} \text{ for all } n \geq 1 \tag{3} \label{eq3}
$$</p>
<p><span style="color:darkgray; font-size: 16pt">Proof: </span>
Theorem 1 implies $l_n(\pi) d_n(\pi) \geq n$ for all $\pi \in S_n$. Note that for every permutation $\pi \in S_n$ there exists an inverse permutation $\pi'$ such that $l_n(\pi) = d_n(\pi&rsquo;)$ and thus we can write $L_n$ also as
$$
L_n = \frac{1}{n!} \sum_{\pi \in S_n} d_n(\pi) \tag{4} \label{eq4}
$$
Therefore, averaging the two ways of computing the expectation $L_n$ (Equations \eqref{eq1} and \eqref{eq4}) and using the AM-GM inequality we have
$$
L_n = \frac{1}{n!} \sum_{\pi \in S_n} \frac{l(\pi) + d(\pi)}{2} \geq \frac{1}{n!} \sum_{\pi \in S_n} \sqrt{l(\pi) d(\pi)} \geq \frac{1}{n!} \sum_{\pi \in S_n} \sqrt{n} = \sqrt{n} \qquad \square
$$</p>
<p><span style="color:darkgray; font-size: 16pt">Theorem 3: </span> Upper bound:
$$
\lims \frac{L_n}{\sqrt{n}} \leq e \tag{5} \label{eq5}
$$</p>
<p><span style="color:darkgray; font-size: 16pt">Proof: </span>
If $\pi \in S_n$ and $1 \leq k \leq n$ let $X_{n,k}(\pi)$ be the number of increasing subsequences of $\pi$ which are of length $k$. They are exactly those subsets $S \subseteq \se{1, \ldots, n}$ such that $|S| = k$ and if $S = \se{i_1 &lt; \cdots &lt; i_k}$ then $\pi(i_1) &lt; \cdots &lt; \pi(i_k)$. On the probability space $(S_n, 2^{S_n}, \mu_n)$, by the linearity of expectation, the expected value of $X_{n,k}$ is given by the number of ways to select $k$ subsets of $\se{1, \ldots, n}$ times the probability that a selection has all the elements in the increasing order. The number of ways is simply $\binom{n}{k}$ and the probability is $1/k!$ and thus
$$
\E[X_{n,k}] = \frac{1}{k!} \binom{n}{k}
$$
The Taylor expansion of $e^x$ implies $e^x \ge x^k / k!$. Substituting $x = k$ we get $k! \geq (k/e)^k$. Therefore, we get
$$
\E[X_{n,k}] = \frac{1}{k!} \binom{n}{k} = \frac{n(n-1) \cdots (n-k-1)}{(k!)^2} \leq \frac{n^k}{(k/e)^{2k}}
$$</p>
<p>Now for a discrete random variable $X_{n,k}$ we can write $\E[X_{n,k}] = \sum_{i=0}^n \mu_n(X_{n,k} \geq i)$ and thus $\mu_n(X_{n,k} \geq 1) \leq \Ex{X_{n,k}}$. Also note that $l_n(\pi) \geq k$ if and only if $X_{n,k}(\pi) \geq 1$. We thus get
$$
\mu_n(l_n \geq k) = \mu_n(X_{n,k} \geq 1) \leq \E[X_{n,k}] \leq \frac{n^k}{(k/e)^{2k}}
$$
Fix an arbitrary $\delta &gt; 0$ and let $k = \ceil{(1+\delta)e\sqrt{n}}$ in the inequality above to get
$$
\mu_n(l_n \geq k) \leq \frac{n^k}{(k/e)^{2k}} \leq \left( \frac{1}{1+\delta} \right)^{2k} \leq \left( \frac{1}{1+\delta} \right)^{2(1+\delta)e\sqrt{n}}
$$
Since $l_n \leq n$, we have
$$
L_n = \Ex{l_n} \leq \mu_n(l_n &lt; k) (1+\delta)e\sqrt{n} + \mu_n(l_n \geq k) n \leq (1+\delta)e\sqrt{n} + O(e^{-c\sqrt{n}})
$$
where $c$ is some positive constant that depends on $\delta$.
Since $\delta$ was arbitrary, we can let $\delta \to 0$ and then take $\limsup$ to get Equation \eqref{eq5}. $\square$</p>
<h1 id="poissonization">Poissonization</h1>
<p>To be able to show \eqref{eq2} we will draw a correspondence between this problem of longest increasing subsequences and a seemingly unrelated problem called the Poissonized version. This Poissonized version will allow us to use the powerful Subadditive Ergodic Theorem (Theorem 5 below) to show \eqref{eq2}.</p>
<p>To this end, assume an underlying probability space $\probsp$ and let $N$ be a Poisson random measure on $\mathbb{R} _ + ^2$ with mean measure given by the Lebesgue measure on $\mathbb{R} _ + ^2$. In other words $N:\Omega \times \B(\R _ + ^2) \to \bar{\R} _ +$ is a transition kernel from $(\Omega, \F)$ into $(\R_+^2, \B(\R_+^2))$ with $\int_\Omega \PP(\dd \omega) N(\omega, A) = \text{Leb}(A)$ for any $A \in \B(\R_+^2)$. We can view the random process as a sequence $\se{(X_i, Y_i)} _ {i \geq 1}$ of independent random variables taking values in $\R _ + ^2$ and having a uniform probability measure (more correctly, Lebesgue measure on $(\R_+^2, \B(\R_+^2))$). If we let $R_{s,t}$ denote the rectangle with vertices $(s,s), (s,t), (t,t)$ and $(t,s)$, then for each outcome $\omega \in \Omega$, we can think of having $\text{Poisson}(\text{Leb}(R_{s,t}(\omega)))$ distributed number of such points inside the rectangle $R_{s,t}(\omega).$</p>
<p>For $s &lt; t \in [0, \infty)$ let $Z_{s,t}$ be the random variable denoting the length of the longest increasing path lying in the rectangle $R_{s,t}$, i.e., $Z_{s,t}$ is the largest integer $k$ for which there are points $(X_1,Y_1), \dots, (X_k, Y_k)$ in the Poisson process with $s &lt; X_1 &lt; \cdots &lt; X_k &lt; t$ and $s&lt; Y_1 &lt; \cdots &lt; Y_k &lt; t$.</p>
<p>Let $\tau(n)$ be the smallest value of $t \in [0, \infty)$ for which there are $n$ points in $R_{0,t}$. Let the $n$ points in $R_{0, \tau(n)}$ be written as $\se{(X_i, Y_i)}_{1 \leq i \leq n}$ such that $0 &lt; X_1 &lt; \cdots &lt; X_n \leq \tau(n)$ (the inequalities are strict almost surely since they have continuous distributions). Let $\pi_n \in S_n$ be the unique permutation such that $Y_{\pi_n(1)} &lt; \cdots &lt; Y_{\pi_{n}(n)}$ (It is not difficult to see the existence and the uniqueness). Then
$$
\pi_n \text{ is a uniformly random sample of } S_n \text{ , and } Z_{0, \tau(n)} = l_n(\pi_n) \tag{6} \label{eq6}
$$
The second claim is obvious from the definition of $\pi_n$. The first claim is equivalent to showing that if $U_1, \ldots, U_n$ are independent random variables sampled from a uniform distribution on $[0,1]$ and if $U_{(1)}, \ldots, U_{(n)}$ are the order statistics, i.e., $U_{(k)}$ is the $k$<sup>th</sup> smallest among $U_1, \ldots, U_n$, then the probability that $U_{(1)}, \ldots, U_{(n)}$ is same as $U_{\pi(1)}, \ldots, U_{\pi(n)}$ for any $\pi \in S_n$ is $1/n!$. But this is obvious from the independence of $U_i$'s. The next theorem is from Durrett:</p>
<p><span style="color:darkgray; font-size: 16pt">Theorem 4: </span> $\tau(n) / \sqrt{n} \to 1$ almost surely.</p>
<p><span style="color:darkgray; font-size: 16pt">Proof: </span>
Let $S_n$ be the number of points in $R_{0,\sqrt{n}}$. Since $(R_{0, \sqrt{n}} \setminus R_{0, \sqrt{n-1}}) \cap (R_{0, \sqrt{m}} \setminus R_{0, \sqrt{m-1}}) = \emp$ for $n \neq m$, the definition of a Poisson random measure implies $\se{S_n - S_{n-1}}_{n \geq 1}$ are independent Poisson random variables with mean $1$. The strong law of large numbers now implies $S_n / n \to 1$ almost surely. For any $\e &gt; 0$ we can find an $n$ large enough such that $S_{n(1-\e)} &lt; n &lt; S_{n(1+\e)}$ but then this means $\sqrt{n(1-\e)} \leq \tau(n) \leq \sqrt{n(1+\e)}$ which is same as the statement of the theorem since $\e$ was arbitrary. $\square$</p>
<p>The last theorem along with \eqref{eq6} implies $Z_{0, \sqrt{n}} \to L_n$ almost surely and thus
$$
\frac{Z_{0,n}}{n} \to \frac{L_{n^2}}{n} \text{ almost surely} \tag{7} \label{eq7}
$$</p>
<h1 id="back-to-longest-increasing-subsequences">Back to longest increasing subsequences</h1>
<p>Having established the connection between the two ways of looking at the problem of longest increasing subsequences, we now freely jump between the two characterizations and use them to prove our results.</p>
<p>Define $W_{s,t} = - Z_{s,t}$. We now check that $W_{m,n}, 0 \le m &lt; n$ satisfies the conditions required for the Subadditive Ergodic Theorem. I state the theorem below for completeness. Check out Theorem 6.4.1 in 
<a href="https://services.math.duke.edu/~rtd/PTE/PTE5_011119.pdf" target="_blank" rel="noopener">Durrett</a> for a proof.</p>
<p><span style="color:darkgray; font-size: 16pt">Theorem 5 [Subadditive Ergodic Theorem]: </span> Suppose $W_{m,n}, 0 \le m &lt; n$ satisfy:</p>
<ol>
<li>$W_{0,m} + W_{m,n} \ge W_{0,n}$,</li>
<li>$\se{W_{nk, (n+1)k}, n \ge 1}$ is a stationary sequence for each $k$,</li>
<li>The distribution of $\se{W_{m,m+k}, k \ge 1}$ does not depend on $m$,</li>
<li>$\Ex{W_{0,1}^+} &lt; \infty$ and $\inf_{n \ge 1} \frac{1}{n} \Ex{W_{0,1}} = \beta &gt; - \infty$.</li>
</ol>
<p>Then</p>
<ul>
<li>$\limn \frac{1}{n} \Ex{W_{0,1}} = \beta$,</li>
<li>$W = \limn \frac{1}{n} W_{0,1}$ exists almost surely and in $L^1$, and $\Ex{X} = \beta$,</li>
<li>If all stationary sequences in 2. are ergodic, then $W = \beta$ almost surely.</li>
</ul>
<p>Coming back to the problem, let $0 &lt; m &lt; n$ then we claim $Z_{0,m} + Z_{m,n} \leq Z_{0,n}$. To see this fix $\omega \in \Omega$ and let $Z_{0,m}(\omega) = a$ and $Z_{m,n}(\omega) = b$. Then there exist $(X_1(\omega), Y_1(\omega)), \ldots (X_a(\omega), Y_a(\omega)), (X_{a+1}(\omega), Y_{a+1}(\omega)), \ldots, (X_{a+b}(\omega), Y_{a+b}(\omega))$ such that $0 &lt; X_1(\omega) &lt; \cdots &lt; X_a(\omega) &lt; m$, $0 &lt; Y_1(\omega) &lt; \cdots &lt; Y_a(\omega) &lt; m$ and $m &lt; X_{a+1}(\omega) &lt; \cdots &lt; X_{a+b}(\omega) &lt; n$, $m &lt; Y_{a+1}(\omega) &lt; \cdots &lt; Y_{a+b}(\omega) &lt; n$. But then it&rsquo;s clear that $0 &lt; X_1(\omega) &lt; \cdots &lt; X_{a+b}(\omega) &lt; n$, $0 &lt; Y_1(\omega) &lt; \cdots &lt; Y_{a+b}(\omega) &lt; n$ and we have  $Z_{0,m}(\omega) + Z_{m,n}(\omega) \leq Z_{0,n}(\omega)$. Since $\omega$ was arbitrary equation our claim is true. Therefore, $W_{0,m} + W_{m,n} \ge W_{0,n}$ and condition 1. is true.</p>
<p>For condition 2. we want to show that $\se{W_{nk, (n+1)k, n \geq 1}}$ is a stationary and ergodic sequence for all $k \geq 1$. This is clear from the observation that $Z_{ik, (i+1)k} \stackrel{d}{=} Y_{0,k}$ since $\text{Leb}(R_{ik, (i+1)k}) = \text{Leb}(R_{0,k})$ and thus by the definition of the Poisson random measure the number of points in each rectangle is an i.i.d. Poisson random variable. Checking the condition 3. is similar to condition 2..</p>
<p>For condition 4. note that $W_{0,1}^+ = Z_{0,1}$ and $Z_{0,1} \leq \text{Poisson}(1)$ since there are $\text{Poisson}(1)$ number of points inside $[0,1]^2$ and at most all of them can be arranged in the increasing order. Thus, $\Ex{W_{0,1}^+} &lt; \Ex{\text{Poisson}(1)} = 1 &lt; \infty$. Now note that since $W_{0,n} = - Z_{0,n}$
$$
\inf_{n \geq 1} \frac{1}{n} \Ex{W_{0,n}} = - \sup_{n \geq 1} \frac{1}{n} \Ex{Z_{0,n}}
$$
and thus to show the second part of condition 4. we need to show that $\sup_{n \geq 1} \frac{1}{n} \Ex{Z_{0,n}} &lt; \infty$. But this is immediate from Equation \eqref{eq5} in Theorem 3 and Equation \eqref{eq7}. Therefore, the subadditive ergodic theorem now implies
$$
\frac{Z_{0,n}}{n} \to \gamma \text{ a.s.}
$$
where $\gamma$ from Equations \eqref{eq3} and \eqref{eq5} lies in $[1,e]$ and we are done since this implies \eqref{eq2}.</p>
<h1 id="epilogue">Epilogue</h1>
<p>I got introduced to this problem from an exam question in a math course I took recently. I recommend the book &ldquo;The Surprising Mathematics of Longest Increasing Subsequences&rdquo; by Dan Romik, which is 
<a href="https://www.math.ucdavis.edu/~romik/book/" target="_blank" rel="noopener">freely available online</a>, for a lot more content.</p>

    </div>

    



















  
  





  
    
    
    
      
    
    
    
    <div class="media author-card content-widget-hr">
      
        
        <img class="avatar mr-3 avatar-circle" src="/author/aditya-makkar/avatar_huafef36e0e38068a1162b930b5509c06d_432110_270x270_fill_q90_lanczos_center.jpg" alt="Aditya Makkar">
      

      <div class="media-body">
        <h5 class="card-title"><a href="https://makkar.github.io/">Aditya Makkar</a></h5>
        
        
        <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.linkedin.com/in/adityamakkar/" target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://twitter.com/MakkarAditya" target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/makkar" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
</ul>

      </div>
    </div>
  














  
  





  </div>
</article>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/8.4.8/mermaid.min.js" integrity="sha256-lyWCDMnMeZiXRi7Zl54sZGKYmgQs4izcT7+tKc+KUBk=" crossorigin="anonymous" title="mermaid"></script>
      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js" integrity="sha256-eOgo0OtLL4cdq7RdwRUiGKLX9XsIJ7nGhWEKbohmVAQ=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/r.min.js"></script>
        
      

    

    
    
      <script async defer src="https://maps.googleapis.com/maps/api/js?key="></script>
      
      <script src="https://cdnjs.cloudflare.com/ajax/libs/gmaps.js/0.4.25/gmaps.min.js" integrity="sha256-7vjlAeb8OaTrCXZkCNun9djzuB2owUsaO72kXaFDBJs=" crossorigin="anonymous"></script>
      
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    <script>const isSiteThemeDark = true;</script>
    

    

    
    

    

    
    

    
    

    
    

    
    

    
    
    
    
    
    
    
    
    
    
    
    
    <script src="/js/academic.min.6f7ce8be710290b8c431bbc97f405d15.js"></script>

    






  
  
  <div class="container">
    <footer class="site-footer">
  

  <p class="powered-by">
    
  </p>

  
  






  <p class="powered-by">

    

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
